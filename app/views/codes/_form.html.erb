<html>
    <head>
        <meta charset="UTF-8">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/ext-language_tools.js"></script>
    </head>
    <body>
        <p class="mb-0">言語：</p>
      <div class="container">
        <div class="row">
        <select id="language" class="custom-select col-md-2">
            <option value="ruby">Ruby</option>
            <option value="python">Python</option>
            <option value="c_cpp">C</option>
        </select>
        <br/>

        <i id="question" class="btn btn-lg ml-5 fas fa-star btn-outline-primary rounded-pill"></i>
        </div>
      </div>

        <p class="mb-0 mt-3">ソースコード：</p>
        <div id="source_code" style="width: 100%; height: 200px; resize: vertical;"></div>

        <p class="mt-3 mb-0">標準入力：</p>
        <textarea id="input" style="width: 100%; height: 50px; resize: vertical;"></textarea>
        <br/>

<ul class="ist-inline">
        <li class="list-inline-item"><button id="run_button" class="btn btn-primary rounded-pill mt-3 btn-lg">実行（Ctrl-Enter）</button></li>
        
            <li class="list-inline-item"><button id="new_code" class="btn btn-outline-primary d-block d-md-inline-block rounded-pill mt-3 btn-lg">コードを新規登録</button></li>
                <% if request.url.include?("edit") %>
                  <li class="list-inline-item"><button id="update_code" class="btn btn-outline-primary d-block d-md-inline-block rounded-pill mt-3 btn-lg">更新して保存</button></li>
                <% end %>
            </ul>
        

<hr>
        標準出力：
        <textarea id="stdout" style="width: 100%; height: 50px; resize: vertical;" class="border border-success"></textarea>
        <!-- <pre class=""><div id="stdout" class="border border-success"></div></pre> -->

        標準エラー出力：
        <pre><div id="stderr" class="bg-danger"></div></pre>

        実行時間：
        <div id="time" class="bg-secondary mb-3"></div>

<!--
        終了コード：
        <div id="exit_code" style="background: lightgray"></div>
    -->  
    </body>
</html>
<%= javascript_include_tag "ui.js" %>
<%= javascript_include_tag "run.js" %>

<script>
$(function() {
  //検索ボタンがクリックされたら処理が走ります。
  $('#question').click(function() {
                //HTMLから受け取るデータです。
                var data = {request : $('#request').val()};
                //ここからajaxの処理です。         
                $.ajax({
                        //POST通信
                        type: "POST",
                        //ここでデータの送信先URLを指定します。
                        url: "ajax.php",
                        data: data,
                        //処理が成功したら
                        success : function(data, dataType) {
                            //HTMLファイル内の該当箇所にレスポンスデータを追加します。
                            $('#res').html(data);
                        },
                        //処理がエラーであれば
                        error : function() {
                            alert('通信エラー');
                        }
                 });
                 //submitによる画面リロードを防いでいます。
                 return false;
    });
  });
</script>